<link href="https://fonts.googleapis.com/css2?family=Poppins:wght@500;700&display=swap" rel="stylesheet">

<nav class="custom-navbar shadow-3">
  <div class="brand">
    <i class="pi pi-shopping-bag"></i> Fashion Hub
  </div>

  <!-- Desktop menu -->
  <div class="nav-icons desktop-only">
    <button pButton icon="pi pi-user" class="nav-btn" (click)="navigateTo('register')"></button>
    <button pButton icon="pi pi-sign-in" class="nav-btn" (click)="navigateTo('login')"></button>
    <button pButton icon="pi pi-shopping-cart" class="nav-btn" (click)="navigateTo('cart')"></button>
    <button pButton icon="pi pi-box" class="nav-btn" (click)="navigateTo('orders')"></button>
    <button pButton icon="pi pi-sign-out" class="nav-btn logout-btn" (click)="logout()"></button>
  </div>

  <!-- Mobile icon -->
  <button class="mobile-menu-btn mobile-only"
    pButton icon="pi pi-bars"
    (click)="toggleMobileMenu()"
    #menuButton>
  </button>
</nav>

<!-- Small Popup Dropdown Under Menu Icon -->
<div class="popup-menu mobile-only"
     *ngIf="mobileMenu"
     [style.top.px]="menuButton.offsetTop + menuButton.offsetHeight + 8"
     [style.left.px]="menuButton.offsetLeft - 80">
  <button pButton label="Register" class="popup-btn" (click)="navigate('register')"></button>
  <button pButton label="Login" class="popup-btn" (click)="navigate('login')"></button>
  <button pButton label="Cart" class="popup-btn" (click)="navigate('cart')"></button>
  <button pButton label="Orders" class="popup-btn" (click)="navigate('orders')"></button>
  <button pButton label="Logout" class="popup-btn logout" (click)="logout()"></button>
</div>


<!-- Product Grid (PrimeFlex responsive columns) -->
<div class="d-flex flex-wrap justify-content-center gap-4 p-3">
  <div *ngFor="let product of paginatedProducts">
    <p-card class="product-card" (click)="viewDetails(product)">
      <div class="product-image">
        <img
          [src]="product.imageUrl"
          [alt]="product.name"
        />
        <span
          *ngIf="product.discount"
          class="discount-badge"
        >
          -{{ product.discount }}%
        </span>
      </div>

      <div class="prod-info">
        <h6>{{ product.name }}</h6>
        <p class="price">₹ {{ product.price }}</p>
      </div>

      <div class="sizes">
        <p-tag
          *ngFor="let s of product.sizes"
          [value]="s"
          class="size-tag"
          [severity]="product.selectedSize === s ? 'success' : 'info'"
          (click)="product.selectedSize = s; $event.stopPropagation()"
        ></p-tag>
      </div>

      <div class="quantity-box">
        <button
    pButton icon="pi pi-minus"
    class="icon-btn"
    (click)="decreaseQuantity(product); $event.stopPropagation()"
  ></button>

  <input
    type="number"
    min="1"
    [(ngModel)]="product.quantity"
    (click)="$event.stopPropagation()"
  />

  <button
    pButton icon="pi pi-plus"
    class="icon-btn"
    (click)="increaseQuantity(product); $event.stopPropagation()"
  ></button>
      </div>

      <button
        pButton
        label="Add To Cart"
        icon="pi pi-shopping-cart"
        class="add-cart-btn w-full"
        (click)="addToCart(product); $event.stopPropagation()"
      ></button>

    </p-card>
  </div>
</div>


<div class="pagination-wrapper">
  <button
    pButton
    icon="pi pi-chevron-left"
    class="pagination-btn prev-btn"
    (click)="prevPage()"
    [disabled]="currentPage === 1"
    pTooltip="Previous"
    tooltipPosition="top"
  ></button>

<p-dropdown
  class="page-dropdown"
  [options]="pageOptions"
  [(ngModel)]="currentPage"
  (onChange)="goToPage()"
  [disabled]="totalPages <= 1"
></p-dropdown>
  <span class="page-text">of {{ totalPages }}</span>

  <button
    pButton
    icon="pi pi-chevron-right"
    class="pagination-btn next-btn"
    (click)="nextPage()"
    [disabled]="currentPage === totalPages"
    pTooltip="Next"
    tooltipPosition="top"
  ></button>
</div>

<!-- Product Detail Dialog (uses selectedProduct) -->
<p-dialog
  *ngIf="selectedProduct"
  [(visible)]="isProductDialogVisible"
  [modal]="true"
  [header]="selectedProduct.name"
  [breakpoints]="{ '960px': '75vw', '640px': '95vw' }"
  [style]="{ width: '700px' }"
  (onHide)="closeDetails()"
  [draggable]="false"
  [resizable]="false"
>
  <div class="dialog-container">
    
    <!-- LEFT: Product Image -->
    <div class="dialog-img-box">
      <img 
        [src]="selectedProduct.imageUrl" 
        [alt]="selectedProduct.name" 
        class="dialog-img"
        (click)="openZoom(selectedProduct!.imageUrl)"
      />
      <span *ngIf="selectedProduct.discount" class="dialog-discount">
        -{{ selectedProduct.discount }}%
      </span>
    </div>

    <!-- RIGHT: Product Info -->
    <div class="dialog-info">

      <h2 class="price-title">
        ₹ {{ selectedProduct.price }}
        <small *ngIf="selectedProduct.discount">
          ({{ selectedProduct.discount }}% OFF)
        </small>
      </h2>

      <p class="category"><strong>Category:</strong> {{ selectedProduct.category }}</p>

      <!-- Size Selection -->
      <p class="label">Available Sizes:</p>
      <div class="size-btn-group">
        <button
          *ngFor="let size of selectedProduct.sizes"
          class="size-btn"
          [class.selected]="selectedProduct.selectedSize === size"
          (click)="selectedProduct!.selectedSize = size"
        >
          {{ size }}
        </button>
      </div>

      <!-- Description -->
      <p class="label">Description:</p>
      <p class="description">{{ selectedProduct.description }}</p>

      <!-- Quantity Box -->
      <div class="product-qty-box">
        <button class="qty-btn" (click)="decreaseQuantity(selectedProduct!)">
          <i class="pi pi-minus"></i>
        </button>

        <input
          type="number"
          [(ngModel)]="selectedProduct!.quantity"
          min="1"
          class="qty-input"
        />

        <button class="qty-btn" (click)="increaseQuantity(selectedProduct!)">
          <i class="pi pi-plus"></i>
        </button>
      </div>

      <!-- Add to Cart -->
      <button
        pButton
        label="Add to Cart"
        icon="pi pi-shopping-cart"
        class="add-cart-dialog-btn"
        (click)="addToCart(selectedProduct!)"
      ></button>

    </div>
  </div>
</p-dialog>

<!-- Footer -->
<footer class="app-footer">
  <div class="footer-container">
    <div class="footer-section">
      <h3>About Us</h3>
      <p>
        Clothing Store is your one-stop shop for trendy and affordable fashion.
        We bring the latest styles right to your doorstep.
      </p>
    </div>

    <div class="footer-section">
      <h3>Contact Us</h3>
      <p><i class="pi pi-map-marker"></i> Ameerpet, Hyderabad, Telangana</p>
      <p><i class="pi pi-phone"></i> +91-8501892849</p>
      <p><i class="pi pi-envelope"></i> subbaraokunchala1128@gmail.com</p>
    </div>

    <div class="footer-section">
      <h3>Quick Links</h3>
      <ul>
        <li><a routerLink="/register">Register</a></li>
        <li><a routerLink="/login">Login</a></li>
        <li><a routerLink="/cart">Cart</a></li>
        <li><a routerLink="/orders">Orders</a></li>
      </ul>
    </div>
  </div>

  <div class="footer-bottom">
    © {{ currentYear }} Clothing Store. All rights reserved.
  </div>
</footer>

